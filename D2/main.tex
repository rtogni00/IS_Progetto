% !TeX document-id = {87432cc9-c386-48dc-9558-b3c42a74a150}
% !TEX encoding = UTF-8
% !TEX TS-program = pdflatex
% !TEX spellcheck = it-IT
%% !TEX root = 
% !BIB TS-program = biber
% Comandi speciali (o righe magiche) trattati come commenti da Latex ma non da 
%editor come Texstudio e Texshop, che si impostano di conseguenza. In ordine:
% dichiara la codifica dei caratteri con cui impostare l'editor (bisogna 
%comunque caricare inputenc con la stessa codifica)
% dichiara il motore di composizione (pdflatex o lualatex)
% attiva il controllo ortografico della lingua del documento
% dichiara la condizione di file principale e di file secondario nei documenti 
%suddivisi in più file
% imposta biber come motore bibliografico

\documentclass[9pt]{extarticle}

\input{packages}



% ------------------------------------------------------------------------------
% Document
% ------------------------------------------------------------------------------


\begin{document}
\customtitle



% TODO add chapters
\tableofcontents
\newpage

\section{Scopo del documento}


Il seguente documento riporta la specifica dei requisiti funzionali del sistema tramite un linguaggio semi-formale. Si tratta dunque di un approfondimento (nonché di una formalizzazione) di quanto riportato in linguaggio naturale all'interno del D1. Il linguaggio utilizzato per la formalizzazione dei requisiti è UML (Unified Modeling Language), declinato in Use Case Diagrams (UCDs), Component Diagrams, Sequence Diagrams, e Class Diagrams.

\newpage

\section{Requisiti Funzionali}

Di seguito sono riportati i functional requirements (FR) del sistema sia in linguaggio naturale che tramite Use Case Diagrams (UCDs). La notazione è coerente con quella utilizzata all'interno del documento D1.

\subsection{FR1 e FR2: Login e Registrazione} 

\begin{figure}[!htb]
	\centering
	\includegraphics[width=.7\linewidth]{./images/FR1-2.pdf}
	\caption{UCD relativo a FR1 e FR2.}
	\label{fig:UCD_FR1-2}
\end{figure}

\subsubsection*{Use Case FR1: Login}

\paragraph{Riassunto}

Lo use case in questione descrive come un utente può effettuare il login al sistema.

\paragraph{Descrizione}

\begin{itemize}
	\item L'utente visualizza una pagina con un form
	\item Se l'utente inserisce le credenziali (vedi  \hyperref[Estensioni-FR2]{Estensioni}) corrette (vedi \hyperref[Eccezioni-FR2]{Eccezioni}) e preme sul pulsante "Login", si apre la schermata principale dell'applicazione.
	\item Qualora l'utente selezioni il logo di Google, il processo di autenticazione verrà gestito da Google SSO
\end{itemize}

\subsubsection*{Use Case FR2: Registrazione}

\paragraph{Riassunto}

Lo use case in questione descrive come un utente può registrarsi al sistema.

\paragraph{Descrizione}

\begin{itemize}
	\item L'utente visualizza una pagina dalla quale inserire username, indirizzo mail e password (vedi \hyperref[Eccezioni-FR2]{Eccezioni})
	\item Il sistema invia una mail all'indirizzo fornito dall'utente contenente un link e una password temporanea
	\item L'utente deve confermare la registrazione tramite il link di cui sopra (vedi \hyperref[Eccezioni-FR2]{Eccezioni}). Può quindi accedere al sistema tramite la password temporanea
\end{itemize}


\subsubsection*{Eccezioni}\label{Eccezioni-FR2}

\begin{itemize}
	\item Qualora le credenziali inserite non siano corrette, l'applicazione restituisce un messaggio di errore
	\item Qualora l'utente non apra il link contenuto nella mail automatica, la registrazione non viene finalizzata
\end{itemize}

\subsubsection*{Estensioni}\label{Estensioni-FR2}

\begin{itemize}
	\item La password contenuta nella mail generata automaticamente dal sistema al termine della registrazione dev'essere modificata a seguito del primo login
\end{itemize}

\subsection{FR4: Visualizzazione Eventi}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=.7\linewidth]{./images/FR4.pdf}
	\caption{UCD relativo al FR4.}
	\label{fig:UCD_FR4}
\end{figure}

\subsubsection*{Use Case FR4: Visualizzazione Eventi}

\paragraph{Riassunto}

Lo use case in questione descrive come un utente può filtrare gli eventi presenti all'interno del sistema.

\paragraph{Descrizione}

\begin{itemize}
	\item La ricerca di eventi può essere effettuata da qualsiasi utente, anche non loggato
	\item L'utente può scegliere se esplorare la mappa integrata nella schermata iniziale, o se visualizzare gli eventi in forma di lista
	\item Qualora l'utente decida di visualizzare la lista degli eventi, viene messo a disposizione un servizio di filtering basato su 3 possibili criteri: data, luogo e nome dell'evento
\end{itemize}

\subsection{FR5, FR6, FR16 e FR17: Feedback, Condivisione, Iscrizione e salvataggio Eventi}


\begin{figure}[!htb]
	\centering
	\includegraphics[width=.6\linewidth]{./images/FR5-6-16-17.pdf}
	\caption{UCD relativo a FR5, FR6, FR16 e FR17.}
	\label{fig:UCD_FR5-6-16-17}
\end{figure}

\subsubsection*{Use Cases FR5, FR6, FR16, FR17}

\paragraph{Riassunto}

Lo use case in questione descrive come un utente può interagire con gli eventi offerti dal sistema. In particolare, descrive le attività di salvataggio, di iscrizione, di condivisione, nonché di valutazione della qualità di un evento.

\paragraph{Descrizione}

\begin{itemize}
	\item Oltre a poter visualizzare gli eventi (come mostrato nello UCD precedente), qualsiasi utente può condividerli
	\item Previo login, qualsiasi tipologia di utente può salvare e/o iscriversi ad un evento. L'iscrizione comporta l'eventuale acquisto di un biglietto
	\item Qualsiasi utente iscritto ad un evento può, dopo il suo verificarsi, lasciare una review
\end{itemize}


\subsection{FR8 e FR10: Creazione ed Aggiornamento Eventi}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/FR8-10.pdf}
	\caption{UCD relativo a FR8 e FR10.}
	\label{fig:UCD_FR8-10}
\end{figure}

\subsubsection*{Use Case FR8: Creazione Eventi}

\paragraph{Riassunto}

Lo use case in questione descrive come un utente appartenente alla categoria "Organizer" oppure "Owner" può creare nuovi eventi.

\newpage

\paragraph{Descrizione}

\begin{itemize}
	\item Qualora l'utente appartenga alla categoria "Owner" o a quella "Organizer" e sia loggato (vedi \hyperref[Eccezioni-FR8-10]{Eccezioni}), dalla pagina del profilo personale è visibile un pulsante "New event"
	\item La pressione del pulsante rimanda alla pagina di creazione eventi. Per la creazione di un nuovo evento è necessario l'inserimento di un nome, di una data, di una location e di una descrizione (vedi \hyperref[Eccezioni-FR8-10]{Eccezioni})
	\item L'aggiunta di immagini è facoltativa, così come lo è il prezzo 
\end{itemize}

\subsubsection*{Use case FR10: Modifica Eventi}

\paragraph{Riassunto}

Lo use case in questione descrive come un utente appartenente alla categoria "Organizer" oppure "Owner" può modificare eventi precedentemente creati.

\paragraph{Descrizione}
\begin{itemize}
	\item Qualora un utente appartenente alle categorie "Owner" o "Organizer" sia loggato e abbia precedentemente creato un evento (vedi \hyperref[Eccezioni-FR8-10]{Eccezioni}), dalla propria pagina personale può raggiungere l'evento in questione tramite il pulsante "My events"
	\item La pressione del pulsante rimanda ad una lista degli eventi creati. Selezionandone uno è possibile modificare uno qualsiasi dei vari campi entro una settimana dall'evento (vedi \hyperref[Eccezioni-FR8-10]{Eccezioni} e \hyperref[Estensioni-FR8-10]{Estensioni})
\end{itemize}

\subsubsection*{Eccezioni}\label{Eccezioni-FR8-10}

\begin{itemize}
	\item Qualora l'utente non sia loggato, non esiste alcun profilo personale
	\item Qualora l'utente appartenga alla categoria "User", la pagina del profilo personale è priva del pulsante per la creazione di eventi
	\item Se durante la creazione di un evento non viene compilato uno dei campi obbligatori, il pulsante "Create Event" rimane inattivo
	\item Qualora l'utente non abbia mai creato eventi, il pulsante "My Events" non è attivo
	\item Qualora manchi meno di una settimana all'evento in questione, i campi non risultano modificabili
\end{itemize}

\subsubsection*{Estensioni}\label{Estensioni-FR8-10}

\begin{itemize}
	\item Gli eventi passati rimangono visualizzabili tramite il pulsante "My events", tuttavia non risultano più editabili
\end{itemize}


\subsection{FR12-13: Aggiunta e Modifica Luogo}


\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/FR12.pdf}
	\caption{UCD relativo al FR12.}
	\label{fig:UCD_FR12}
\end{figure}

\subsubsection*{Use Case FR12: Aggiunta Luogo}

\paragraph{Riassunto}

Lo use case in questione descrive come un utente appartenente alla categoria "Owner" può aggiungere una location.

\paragraph{Descrizione}

\begin{itemize}
	\item Qualora l'utente sia loggato con un profilo di tipo "Owner" (vedi \hyperref[Eccezioni-FR12-13]{Eccezioni}), dal proprio profilo personale ha la possibilità di aggiungere un luogo tramite il pulsante "New Place"
	\item La pressione del pulsante rimanda alla pagina di aggiunta luoghi. Per l'aggiunta di un nuovo luogo occorre inserire una location, un nome, una descrizione, ed un prezzo (vedi \hyperref[Eccezioni-FR12-13]{Eccezioni}). Opzionalmente è possibile inserire delle foto.
\end{itemize}

\subsubsection*{Use Case FR13: Modifica Luogo}

\paragraph{Riassunto}

Lo use case in questione descrive come un utente appartenente alla categoria "Owner" può modificare una location precedentemente inserita nel sistema.

\paragraph{Descrizione}

\begin{itemize}
	\item Qualora l'utente sia loggato con un profilo di tipo "Owner" e abbia precedentemente aggiunto una location, dalla propria pagina personale può raggiungere l'evento in questione tramite il pulsante "My places"
	\item La pressione del pulsante rimanda ad una lista degli spazi aggiunti. Selezionandone uno è possibile modificare uno qualsiasi dei campi e/o eliminare lo spazio se e solo se lo spazio non è attualmente collegato ad un evento (vedi \hyperref[Eccezioni-FR12-13]{Eccezioni})
\end{itemize}

\subsubsection*{Eccezioni}\label{Eccezioni-FR12-13}
\begin{itemize}
	\item Qualora l'utente non sia loggato, non esiste alcun profilo personale
	\item Qualora l'utente non appartenga alla categoria "Owner", la pagina del profilo personale è priva del pulsante per l'aggiunta di spazi
	\item Se durante l'aggiunta di uno spazio non viene compilato uno dei campi obbligatori, il pulsante "Create Place" rimane inattivo
	\item Qualora lo spazio sia collegato ad un evento, le modifiche sono disattivate a partire da 7 giorni prima della data prevista per l'evento
\end{itemize}

\newpage
\section{Sequence Diagrams}

Gli use case diagrams riportati nel capitolo precendente rappresentano una overview delle funzionalità del sistema. Nel presente capitolo tali funzionalità vengono estese tramite l'introduzione di un aspetto temporale. L'impiego di sequence diagrams consente quindi di rappresentare l'ordine cronologico con cui i vari elementi dei singoli scenari si verificano, dettagliando il modo in cui gli oggetti collaborano al fine di ottenere la piena funzionalità del sistema.

\textbf{Login}
\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/SequenceDiagramLogin.pdf}
	\caption{Sequence diagram rappresentante la procedura di login.}
	\label{fig:SeqDiagLogin}
\end{figure}

\newpage
\textbf{Registrazione utente}
\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/SequenceDiagramRegistration.pdf}
	\caption{Sequence diagram rappresentante la procedura di registrazione.}
	\label{fig:SeqDiagReg}
\end{figure}

\newpage
\textbf{Browsing eventi}
\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/SequenceDiagramBrowseEvents.pdf}
	\caption{Sequence diagram rappresentante il browsing degli eventi.}
	\label{fig:SeqDiagBrowseEvents}
\end{figure}

\newpage
\textbf{Iscrizione ad un evento}
\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/SequenceDiagramEventEnrolling.pdf}
	\caption{Sequence diagram rappresentante l'iscrizione ad un evento.}
	\label{fig:SeqDiagEventEnroll}
\end{figure}

\newpage\textbf{Creazione di un evento}
\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/SequenceDiagramEventCreation.pdf}
	\caption{Sequence diagram rappresentante la creazione di un evento.}
	\label{fig:SeqDiagEventCreation}
\end{figure}

\newpage
\textbf{Eliminazione di un evento}
\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/SequenceDiagramEventDeletion.pdf}
	\caption{Sequence diagram rappresentante la reimozione di un evento creato in precedenza.}
	\label{fig:SeqDiagEventDeletion}
\end{figure}

\newpage
\textbf{Modifica di un evento}
\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/SequenceDiagramEventModification.pdf}
	\caption{Sequence diagram rappresentante la modifica di un evento creato in precedenza.}
	\label{fig:SeqDiagEventModification}
\end{figure}

\newpage

\textbf{Aggiunta di un luogo}
\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/SequenceDiagramAddPlace.pdf}
	\caption{Sequence diagram rappresentante l'aggiunta di un luogo.}
	\label{fig:SeqDiagAddPlace}
\end{figure}

\newpage

\textbf{Rimozione di un luogo}
\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/SequenceDiagramPlaceDeletion.pdf}
	\caption{Sequence diagram rappresentante la rimozione di un luogo.}
	\label{fig:SeqDiagRemovePlace}
\end{figure}

\newpage


\textbf{Modifica di un luogo}
\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/SequenceDiagramEditPlace.pdf}
	\caption{Sequence diagram rappresentante la modifica di un luogo.}
	\label{fig:SeqDiagEditPlace}
\end{figure}


\newpage
\section{Analisi dei Componenti}

In questo capitolo vengono presentati i componenti che costituiscono l'architettura del sistema, e che sottostanno alle funzionalità definite in precedenza. L'interconnessione tra i vari componenti è rappresentata tramite l'utilizzo di un component diagram, il quale rende esplicita la presenza di interfacce sia tra i componenti  stessi che con sistemi esterni.

\subsection{Definizione dei Componenti}

\subsubsection*{CMP1: Gestione Registrazione}
\paragraph{Descrizione}
Il componente si occupa della funzionalità di registrazione di un nuovo account.

\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Credenziali di accesso: le credenziali includono email e password
\end{itemize}

\subparagraph{Interfacce Fornite}
\begin{itemize}
	\item Nuovo utente: una volta completata la procedura di registrazione, il nuovo profilo viene salvato all'interno del database
\end{itemize}


\subsubsection*{CMP2: Gestione autenticazione}
\paragraph{Descrizione}
Il componente gestisce il login al sistema. Interagisce con gli altri componenti per gestire la separazione tra attività che richiedono un profilo e attività aperte agli utenti non registrati.
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Credenziali di accesso: le credenziali includono email e password
	\item Verifica delle credenziali: il sistema confronta le credenziali inserite con quelle presenti nel database
\end{itemize}

\subparagraph{Interfacce Fornite}
\begin{itemize}
	\item Conferma credenziali: garantisce che l'utente sia loggato, permettendo dunque agli altri componenti di fornire funzionalità specifiche agli utenti con un profilo di un certo tipo
\end{itemize}

\subsubsection*{CMP3: Gestione database}
\paragraph{Descrizione}
Il componente salva i dati relativi ad utenti, eventi e luoghi all'interno del database.
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Credenziali utente: quando un nuovo utente si registra al sistema, i dati vengono salvati nel database
	\item Dati relativi ai luoghi: la componente deve avere accesso ai luoghi salvati nel database, nonché alla variazione dei dati determinata dall'update o dalla rimozione di un luogo precedentemente inserito
	\item Dati profilo: la componente deve avere accesso alla variazione dei dati personali causata da una modifica del profilo utente
	\item Dati relativi agli eventi: la componente deve avere accesso agli eventi salvati nel database, nonché  alla variazione dei dati determinata dall'update o dalla rimozione di un evento precedentemente inserito
\end{itemize}
\subparagraph{Interfacce Fornite}
\begin{itemize}
	\item Dati relativi ai luoghi: la componente fornisce le informazioni relative ai luoghi presenti nel database
	\item Dati degli utenti: la componente fornisce le informazioni relative ai profili utenti presenti nel database
	\item Dati relativi agli eventi: la componente fornisce le informazioni relative agli eventi presenti nel database
\end{itemize}



\subsubsection*{CMP4: Area personale}
\paragraph{Descrizione}
Il componente gestisce il profilo utente, oltre a fungere da tramite per le attività che necessitano che l'utente possieda un profilo personale.

\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Autenticazione: la gestione del profilo è una funzionalità offerta solamente agli utenti che ne possiedono uno
\end{itemize}
\subparagraph{Interfacce Fornite}
\begin{itemize}
	\item Accesso al modulo per la gestione degli eventi a cui l'utente è iscritto
	\item Acceso al modulo per la gestione degli eventi salvati
\end{itemize}

\subsubsection*{CMP5: Modulo di gestione degli eventi salvati}
\paragraph{Descrizione}
Il componente si occupa della gestione degli eventi salvati
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Accesso all'area personale
\end{itemize}
\subsection{Interfacce Fornite}
\begin{itemize}
	\item Rimozione di un evento dalla lista degli eventi salvati
\end{itemize}

\subsubsection*{CMP6: Modulo di gestione degli eventi a cui si è iscritti}
\paragraph{Descrizione}
Il componente si occupa della gestione degli eventi a cui un utente è iscritto
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Accesso all'area personale
\end{itemize}
\subsection{Interfacce Fornite}
\begin{itemize}
	\item Disiscrizione da un evento
\end{itemize}

\subsubsection*{CMP7: Location list service}
\paragraph{Descrizione}
Il componente si occupa della gestione dei luoghi creati da un utente di tipo owner
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Accesso all'area personale
\end{itemize}
\subsection{Interfacce Fornite}
\begin{itemize}
	\item Luoghi creati dall'utente
\end{itemize}

\subsubsection*{CMP8: Location Creation service}
\paragraph{Descrizione}
Il componente si occupa della creazione di una nuova location
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Accesso all'area personale
\end{itemize}
\subsection{Interfacce Fornite}
\begin{itemize}
	\item Creazione di una nuova location
\end{itemize}

\subsubsection*{CMP9: Location Deletion service}
\paragraph{Descrizione}
Il componente si occupa dell'eliminazione di una location
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Accesso all'area personale
\end{itemize}
\subsection{Interfacce Fornite}
\begin{itemize}
	\item Eliminazione di una location esistente
\end{itemize}

\subsubsection*{CMP10: Location Modification service}
\paragraph{Descrizione}
Il componente si occupa della modifica di una location precedentemente creato
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Accesso all'area personale
\end{itemize}
\subsection{Interfacce Fornite}
\begin{itemize}
	\item Modifica dei dati di una location esistente
\end{itemize}

\subsubsection*{CMP11: Gestione mappa}
\paragraph{Descrizione}
Il componente mostra una mappa con la posizione degli eventi disponibili
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Eventi: i dati relativi agli eventi
\end{itemize}
\subparagraph{Interfacce Fornite}
\begin{itemize}
	\item Eventi: la posizione degli eventi, sottoforma di pallini sulla mappa
\end{itemize}

\subsubsection*{CMP12: Sistema di ricerca eventi}
\paragraph{Descrizione}
Il componente consente di effettuare la ricerca di eventi presenti nel database.
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Eventi: i dati relativi agli eventi presenti nel database
	\item Criteri di ricerca: i filtri da utilizzare nella ricerca degli eventi
\end{itemize}
\subparagraph{Interfacce Fornite}
\begin{itemize}
	\item Eventi: gli eventi che coincidono con i filtri di ricerca utilizzati
	\item Accesso al modulo per il salvataggio di un evento
	\item Accesso al modulo per l'iscrizione ad un evento
\end{itemize}

\subsubsection*{CMP13: Gestione iscrizione eventi}
\paragraph{Descrizione}
Il componente consente l'iscrizione ad un evento
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Autenticazione: solo gli utenti in possesso di un profilo possono iscriversi ad un evento
	\item Dati evento: le informazioni relative all'evento a cui l'utente loggato desidera iscriversi
\end{itemize}
\subparagraph{Interfacce Fornite}
\begin{itemize}
	\item Nuova iscrizione all'evento
\end{itemize}

\subsubsection*{CMP14: Gestione salvataggio eventi}
\paragraph{Descrizione}
Il componente consente il salvataggio di un evento
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Autenticazione: solo gli utenti in possesso di un profilo possono iscriversi ad un evento
	\item Dati evento: le informazioni relative all'evento a cui l'utente loggato desidera iscriversi
\end{itemize}
\subparagraph{Interfacce Fornite}
\begin{itemize}
	\item Nuovo salvataggio dell'evento
\end{itemize}

\subsubsection*{CMP15: Event list service}
\paragraph{Descrizione}
Il componente si occupa della gestione degli eventi creati da un utente di tipo organiser
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Accesso all'area personale
\end{itemize}
\subsection{Interfacce Fornite}
\begin{itemize}
	\item Eventi organizzati dall'utente
\end{itemize}

\subsubsection*{CMP16: Event Creation service}
\paragraph{Descrizione}
Il componente si occupa della creazione di un nuovo evento
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Accesso all'area personale
\end{itemize}
\subsection{Interfacce Fornite}
\begin{itemize}
	\item Creazione di un nuovo evento
\end{itemize}

\subsubsection*{CMP17: Event Deletion service}
\paragraph{Descrizione}
Il componente si occupa dell'eliminazione di un evento
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Accesso all'area personale
\end{itemize}
\subsection{Interfacce Fornite}
\begin{itemize}
	\item Eliminazione di un evento esistente
\end{itemize}

\subsubsection*{CMP18: Event Modification service}
\paragraph{Descrizione}
Il componente si occupa della modifica dei dati relativi ad un evento precedentemente creato
\subparagraph{Interfacce Richieste}
\begin{itemize}
	\item Accesso all'area personale
\end{itemize}
\subsection{Interfacce Fornite}
\begin{itemize}
	\item Modifica dei dati di un evento esistente
\end{itemize}

\subsection{Diagramma dei Componenti}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/ComponentDiagramV2.pdf}
	\caption{Diagramma complessivo dei componenti di sistema e delle loro interconnessioni.}
	\label{fig:ComponentDiagram}
\end{figure}



\newpage

\section{Diagramma delle Classi}

Nel seguente capitolo vengono presentate le classi previste nell'ambito del progetto "EvenTrento". Ogni classe rappresenta un elemento del sistema, ed è caratterizzata da un nome, da una lista di attributi e da (opzionale) una lista di metodi.
Mentre le classi rappresentano i dati gestiti e/o utilizzati dalla classe, i metodi definiscono le operazioni rese disponibili dalla classe in questione. L'interazione tra le varie classi è codificata tramite le connessioni rese disponibili dalla sintassi UML.

Di seguito sono riportate le classi individuate, raggruppate per sottosistema di appartenenza.

\subsection{Diagrammi delle Classi Parziali}

\textbf{Categorie di utente}


I tre tipi di utente previsti dal sistema sono formalizzate mediante l'utilizzo di ereditarietà. In particolare, la classe \verb*|BasicUser| include tutte le caratteristiche offerte ad utenti appartenti a tutte e tre le categorie. Ogni utente è associato a dei dati personali, e può effettuare quanto previsto dai requisiti funzionali tramite i metodi \verb*|register()|, \verb*|login()|, \verb*|logout()|, \verb*|saveEvent(eventId)|, \verb*|unsaveEvent(eventId)|, \verb*|enrollEvent(eventId)|, \verb*|unenrollEvent(eventId)|, \verb*|getSavedEvents()|, \verb*|getEnrolledEvents()|, e \verb*|changePwd()|.


La classe \verb*|Organizer| estende \verb*|BasicUser| aggiungendo tutte le attività collegate alla creazione, alla modifica e alla rimozione di eventi. Analogamente, la classe \verb*|Owner| estende \verb*|BasicUser| tramite l'aggiunta delle attività relative alla gestione degli spazi.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=.8\linewidth]{./images/classDiagramUsers.pdf}
		\caption{}
	\label{fig:classDiagramUsers}
\end{figure}

\newpage

\textbf{Autenticazione}

L'autenticazione è gestita tramite JWT tokens. Tale processo è rappresentato mediante la classe \verb*|Authentication|, come mostrato in Figura \ref{fig:classDiagramAuthentication}.


\begin{figure}[!htb]
	\centering
	\includegraphics[width=.8\linewidth]{./images/classDiagramAuthentication.pdf}
	\caption{}
	\label{fig:classDiagramAuthentication}
\end{figure}

\textbf{Gestione eventi}

Gli eventi sono rappresentati dalla classe \verb*|Event|, la quale si appoggia alle classi :
\begin{itemize}
	\item \verb*|Place| per la scelta del luogo in cui si svolgerà l'evento
	\item \verb*|Date| per specificare il giorno previsto per l'evento
	\item \verb*|EventDescription| per fornire una descrizione dettagliata dell'evento
\end{itemize}

La ricerca di eventi è gestita dalla classe \verb*|EventSearch|, la quale comunica con la classe \verb*|BasicUser|. L'iscrizione ad eventi e il loro salvataggio sono invece gestite direttamente all'interno della classe \verb*|BasicUser|.

La classe \verb*|Event| è inoltre collegata alla classe \verb*|Organizer|, a rappresentare l'attività di creazione eventi associata a tale categoria di utente.

\newpage

\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/classDiagramEventEnrollment.pdf}
	\caption{}
	\label{fig:classDiagramEventEnrollment}
\end{figure}

\textbf{Gestione degli spazi}

Gli spazi sono rappresentati dalla classe \verb*|Places|, la quale si appoggia alla classe \verb*|Address| per meglio rappresentare la collocazione del locale. L'attributo \verb*|available| ha lo scopo di rappresentare la disponibilità del locale, in modo che questo non possa essere scelto come location per più eventi simultaneamente.

\newpage
\begin{figure}[!htb]
	\centering
	\includegraphics[width=.6\linewidth]{./images/classDiagramPlaces.pdf}
	\caption{}
	\label{fig:classDiagramPlaces}
\end{figure}


\subsection{Diagramma delle Classi Complessivo}

Di seguito è riportato il diagramma di tutte le classi precedentemente descritte.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth]{./images/classDiagram.pdf}
	\caption{}
	\label{fig:classDiagram}
\end{figure}

\newpage
\section{Dal Class Diagrams alle APIs}

Lo scopo di questo capitolo consiste nel rappresentare un punto di incontro tra l'aspetto progettuale e quello implementativo del progetto. In particolare, nella seguente tabella sono riportati i vari metodi presenti all'interno del class diagram mostrato in Figura \ref{fig:classDiagram} e la loro controparte in termini di APIs. 


\begin{table}[!htb]
\resizebox{\textwidth}{!}{%
\begin{tabular}{lllllll}
	\toprule
	Classe          & Metodo                               & HTTP Method & URI + query params               & Request                        & Response                          & Note \\ \midrule
	BasicUser       
	& register()                           & POST        & /api/v1/users/signup            & JSON {username, email, password, role}         & JSON {message, user, token}           & Crea un nuovo utente \\
	& login()                              & POST        & /api/v1/users/login               & JSON {email, password}         & JSON {message, token}           & Restituisce il token JWT \\
	& logout()                             & POST        & /api/v1/users/logout              &  & JSON {message}                   & Invalida il token \\
	& enroll(eventId)()                    & POST        & /api/v1/events/{eventId}/enroll   &   JSON {enrolledEvents} & JSON {message}                                            & Iscrive l'utente ad un evento  \\
	& unenroll(eventId)()                    & POST        & /api/v1/events/{eventId}/unenroll   &  JSON {enrolledEvents} & JSON {message}                                            & Disiscrive l'utente da un evento  \\
	& saveEvent(eventId)                   & POST        & /api/v1/events/{eventId}/save     & JSON {savedEvents}  & JSON {message}                   & Salva un evento nei preferiti \\
	& unsaveEvent(eventId)                   & POST        & /api/v1/events/{eventId}/unsave     & JSON {savedEvents}  & JSON {message}                   & Rimuove un evento dai preferiti \\
	& getSavedEvents()                     & GET         & /api/v1/users/savedEvents         &  & JSON {events: [{\_id, name}]}         & Ottiene gli eventi salvati \\
	& getEnrolledEvents()                  & GET         & /api/v1/users/enrolledEvents         & Header {Authorization: Token}  & JSON {events: [{\_id, name}]}         & Ottiene gli eventi a cui l'utente è iscritto \\
	& changePwd()                          & PUT         & /api/v1/users/changePwd     & JSON {oldPwd, newPwd}          & JSON {message}                   & Modifica la password \\ \midrule

	
	Organizer       
	& createEvent()                        & POST        & /api/v1/events/create                 & JSON {eventData}               & JSON {event}                     & Crea un evento \\
	& updateEvent(eventId)                 & PUT         & /api/v1/events/{eventId}/update         & JSON {eventData}               & JSON {event}                     & Aggiorna un evento \\
	& deleteEvent(eventId)                 & DELETE      & /api/v1/events/{eventId}/delete          &  & JSON {message}                   & Elimina un evento \\ \midrule
	
	Owner           
	& createPlace()                        & POST        & /api/v1/places/create                  & JSON {placeData}               & JSON {place}                     & Crea un luogo \\
	& updatePlace(placeId)                 & PUT         & /api/v1/places/{placeId}/update        & JSON {placeData}               & JSON {place}                     & Modifica un luogo \\
	& deletePlace(placeId)                 & DELETE      & /api/v1/places/{placeId}/delete          &  & JSON {message}                   & Elimina un luogo \\ \midrule
	
	Event           
	& setPlace()                           & PUT         & /api/v1/events/{eventId}/setPlace    & JSON {placeId}                 & JSON {event}                     & Assegna un luogo a un evento \\
	%	& setDate()                            & PUT         & /api/v1/events/{eventId}/setDdate     & JSON {date}                    & JSON {event}                     & Imposta la data di un evento \\ \midrule
	EventSearch     
	& filterEvents(criteria)               & GET         & /api/v1/events?filter={criteria}  & JSON query params                   & JSON {events}                    & Filtra gli eventi \\ \midrule
	
	Authentication  
	& middleware                &         & Applied to protected routes                &  Header {Authorization: Token}              & JSON {success, message}                     & Verifica il token e lo assegna a \texttt{req.loggedUser} \\\bottomrule
\end{tabular}%
}
\caption{Dal class diagram alle APIs.}
\label{tab:class2API}
\end{table}



Si noti come l'iscrizione e il salvataggio di eventi, seppur rappresentati come metodi appartenenti alla classe \verb*|BasicUser|, siano effettivamente implementati all'interno della route \verb*|events|. L'unico parametro è l'id dell'evento in questione in quanto l'identità dell'utente deriva dal middleware di autenticazione. Tale scelta implementativa è giustificata semplicemente da una maggiore linearità del codice, e non impatta in alcun modo sulla funzionalità del sistema.

Un'ulteriore differenza tra il diagramma a classi presentato e l'effettiva implementazione consiste nell'utilizzo di un singolo authentication middleware per la gestione di tutte le attività che necessitano di un account.

\end{document}
